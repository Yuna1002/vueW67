import{M,D as k}from"./DelModal-d28be0b5.js";import{_ as y,o as d,c as i,b as t,h as c,i as u,F as P,f as U,t as h,l as I,r as g,d as v}from"./index-ce484b6b.js";import{P as V}from"./PaginationCpmponent-fa660c8b.js";const{VITE_APP_URL:x,VITE_APP_PATH:A}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"yuna1002",BASE_URL:"/vueW67/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},E={props:["isNew","editItem"],emits:["addProduct","editProduct"],data(){return{productModal:{},tempProduct:{imagesUrl:[]}}},methods:{show(){this.productModal.show()},hide(){this.productModal.hide()},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")},upload(){const l=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",l),this.$http.post(`${x}/api/${A}/admin/upload`,e).then(n=>{this.tempProduct.imageUrl=n.data.imageUrl,this.$refs.fileInput.value=""}).catch(n=>{console.log(n)})}},watch:{editItem(){this.tempProduct=this.editItem}},mounted(){this.productModal=new M(this.$refs.modal)}},D={ref:"modal",id:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},C={class:"modal-dialog modal-xl"},T={class:"modal-content border-0"},R=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$={class:"modal-body"},L={class:"row"},N={class:"col-sm-4"},S={class:"mb-5"},B=t("h4",null,"主圖",-1),H={class:"mb-3"},O=["src"],F=t("h4",{class:"mb-3"},"多圖新增",-1),G={key:0},W={class:"form-label"},j=["onUpdate:modelValue"],q=["src"],z={key:1},J={class:"col-sm-8"},K={class:"mb-3"},Q=t("label",{for:"title",class:"form-label"},"標題",-1),X={class:"row"},Y={class:"mb-3 col-md-6"},Z=t("label",{for:"category",class:"form-label"},"分類",-1),tt={class:"mb-3 col-md-6"},et=t("label",{for:"price",class:"form-label"},"單位",-1),ot={class:"row"},st={class:"mb-3 col-md-6"},lt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),dt={class:"mb-3 col-md-6"},it=t("label",{for:"price",class:"form-label"},"售價",-1),nt=t("hr",null,null,-1),rt={class:"mb-3"},ct=t("label",{for:"description",class:"form-label"},"產品描述",-1),at={class:"mb-3"},ut=t("label",{for:"content",class:"form-label"},"說明內容",-1),mt={class:"mb-3"},pt={class:"form-check"},ht=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),_t={class:"modal-footer"},bt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Pt(l,e,n,p,o,r){return d(),i("div",D,[t("div",C,[t("div",T,[R,t("div",$,[t("div",L,[t("div",N,[t("div",S,[B,t("div",H,[c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.imageUrl=s)},null,512),[[u,o.tempProduct.imageUrl]]),t("input",{type:"file",onChange:e[1]||(e[1]=(...s)=>r.upload&&r.upload(...s)),ref:"fileInput"},null,544)]),t("img",{class:"img-fluid",src:o.tempProduct.imageUrl,alt:"tempProduct.title"},null,8,O)]),t("div",null,[F,Array.isArray(o.tempProduct.imagesUrl)?(d(),i("div",G,[(d(!0),i(P,null,U(o.tempProduct.imagesUrl,(s,m)=>(d(),i(P,{key:m},[t("label",W,[t("strong",null,h(`圖片${m+1}`),1)]),c(t("input",{type:"text","onUpdate:modelValue":f=>o.tempProduct.imagesUrl[m]=f,class:"form-control",placeholder:"請輸入圖片網址"},null,8,j),[[u,o.tempProduct.imagesUrl[m]]]),t("img",{class:"img-fluid mb-4",src:s,alt:""},null,8,q)],64))),128)),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(d(),i("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=s=>o.tempProduct.imagesUrl.push(""))}," (內層)新增圖片 ")):(d(),i("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[3]||(e[3]=s=>o.tempProduct.imagesUrl.pop(""))}," 刪除圖片 "))])):(d(),i("div",z,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[4]||(e[4]=(...s)=>r.createImages&&r.createImages(...s))}," (外層)新增圖片 ")]))])]),t("div",J,[t("div",K,[Q,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.title=s)},null,512),[[u,o.tempProduct.title]])]),t("div",X,[t("div",Y,[Z,c(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.category=s)},null,512),[[u,o.tempProduct.category]])]),t("div",tt,[et,c(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.unit=s)},null,512),[[u,o.tempProduct.unit]])])]),t("div",ot,[t("div",st,[lt,c(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.origin_price=s)},null,512),[[u,o.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",dt,[it,c(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.price=s)},null,512),[[u,o.tempProduct.price,void 0,{number:!0}]])])]),nt,t("div",rt,[ct,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.description=s)},`
                `,512),[[u,o.tempProduct.description]])]),t("div",at,[ut,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[11]||(e[11]=s=>o.tempProduct.content=s)},`
                `,512),[[u,o.tempProduct.content]])]),t("div",mt,[t("div",pt,[c(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[12]||(e[12]=s=>o.tempProduct.is_enabled=s)},null,512),[[I,o.tempProduct.is_enabled]]),ht])])])])]),t("div",_t,[bt,n.isNew?(d(),i("button",{key:0,type:"button",class:"btn btn-primary",onClick:e[13]||(e[13]=s=>l.$emit("addProduct",o.tempProduct))}," 確認 ")):(d(),i("button",{key:1,type:"button",class:"btn btn-primary",onClick:e[14]||(e[14]=s=>l.$emit("editProduct",o.tempProduct.id,o.tempProduct))}," 確認 "))])])])],512)}const ft=y(E,[["render",Pt]]),{VITE_APP_URL:_,VITE_APP_PATH:b}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"yuna1002",BASE_URL:"/vueW67/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},gt={data(){return{products:[],isNew:!0,editItem:{},pages:{}}},components:{ProductModal:ft,DelModal:k,PaginationCpmponent:V},methods:{getProducts(l=1){this.$http.get(`${_}/api/${b}/admin/products/?page=${l}`).then(e=>{this.products=e.data.products,this.pages=e.data.pagination}).catch(e=>{alert(e.data.message)})},openModal(l,e){l==="new"?(this.editItem={},this.isNew=!0,this.$refs.productModal.show()):l==="edit"?(this.editItem={...e},this.isNew=!1,this.$refs.productModal.show()):l==="del"&&(this.editItem={...e},this.$refs.delProductModal.show())},addProduct(l){const e=l;this.$http.post(`${_}/api/${b}/admin/product`,{data:e}).then(n=>{alert(n.data.message),this.$refs.productModal.hide(),this.getProducts()}).catch(n=>{console.log(n.data.message)})},editProduct(l,e){const n=e;this.$http.put(`${_}/api/${b}/admin/product/${l}`,{data:n}).then(p=>{alert(p.data.message),this.$refs.productModal.hide(),this.getProducts()}).catch(p=>{console.log(p)})},delProduct(l){this.$http.delete(`${_}/api/${b}/admin/product/${l}`).then(e=>{alert(e.data.message),this.$refs.delProductModal.hide(),this.getProducts()}).catch(e=>{console.log(e)})}},mounted(){this.getProducts()}},vt={class:"text-end mt-4"},yt={class:"table mt-4"},Ut=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),wt={class:"text-end"},Mt={class:"text-end"},kt={key:0,class:"text-success"},It={key:1},Vt={class:"btn-group"},xt=["onClick"],At=["onClick"];function Et(l,e,n,p,o,r){const s=g("ProductModal"),m=g("DelModal"),f=g("PaginationCpmponent");return d(),i(P,null,[t("div",vt,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=a=>r.openModal("new"))}," 建立新的產品 ")]),t("table",yt,[Ut,t("tbody",null,[(d(!0),i(P,null,U(o.products,a=>(d(),i("tr",{key:a.id},[t("td",null,h(a.category),1),t("td",null,h(a.title),1),t("td",wt,h(a.origin_price),1),t("td",Mt,h(a.price),1),t("td",null,[a.is_enabled?(d(),i("span",kt,"啟用")):(d(),i("span",It,"未啟用"))]),t("td",null,[t("div",Vt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:w=>r.openModal("edit",a)}," 編輯 ",8,xt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:w=>r.openModal("del",a)}," 刪除 ",8,At)])])]))),128))])]),v(s,{ref:"productModal","is-new":o.isNew,"edit-item":o.editItem,onAddProduct:r.addProduct,onEditProduct:r.editProduct},null,8,["is-new","edit-item","onAddProduct","onEditProduct"]),v(m,{ref:"delProductModal",temp:o.editItem,onDel:r.delProduct},null,8,["temp","onDel"]),v(f,{pages:o.pages,onGetData:r.getProducts},null,8,["pages","onGetData"])],64)}const Rt=y(gt,[["render",Et]]);export{Rt as default};
