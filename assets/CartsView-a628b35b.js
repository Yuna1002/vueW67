import{_ as k,r as f,o as r,c as m,b as e,F as b,f as V,g as x,t as _,d as n,w as I,e as P,h as y,v as U,n as c,i as E}from"./index-ce484b6b.js";const{VITE_APP_URL:h,VITE_APP_PATH:p}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"yuna1002",BASE_URL:"/vueW67/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},q={data(){return{carts:[],total:0,loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){this.$http.get(`${h}/api/${p}/cart`).then(a=>{console.log("購物車",a.data.data.carts),this.carts=a.data.data.carts,this.total=a.data.data.total}).catch(a=>{console.log(a.data)})},delCart(a){this.loadingItem=a,this.$http.delete(`${h}/api/${p}/cart/${a}`).then(s=>{alert(s.data.message),this.loadingItem="",this.getCarts()}).catch(s=>{console.log(s)})},updateCart(a,s,g){this.loadingItem=a;const v={product_id:s,qty:g};this.$http.put(`${h}/api/${p}/cart/${a}`,{data:v}).then(t=>{alert(t.data.message),this.loadingItem="",this.getCarts()}).catch(t=>{console.log(t)})},submitOrder(){const a=this.form;this.$http.post(`${h}/api/${p}/order`,{data:a}).then(s=>{alert(s.data.message),this.$refs.form.resetForm(),this.getCarts()}).catch(s=>{console.log(s)})},checkMobile(a){return a?/^(09)[0-9]{8}$/.test(a)?!0:"行動電話格式有誤":!0}},mounted(){this.getCarts()}},T=e("h2",{class:"text-center mb-5"},"購物車",-1),w={class:"table align-middle"},A=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",{class:"text-end"},"單價")])],-1),S=["onClick","disabled"],D={key:0,class:"fas fa-spinner fa-pulse"},M={class:"input-group input-group-sm"},R={class:"input-group mb-3"},B=["onUpdate:modelValue","onChange","disabled"],L=["value"],N=e("span",{class:"input-group-text",id:"basic-addon2"},"顆",-1),O={class:"text-end"},F=e("td",{colspan:"3",class:"text-end"},"總計",-1),H={class:"text-end"},j={class:"my-5 row justify-content-center"},z={class:"mb-3"},W=e("label",{for:"email",class:"form-label me-1"},"Email",-1),G=e("span",{class:"badge text-danger"},"*必填",-1),J={class:"mb-3"},K=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),Q=e("span",{class:"badge text-danger"},"*必填",-1),X={class:"mb-3"},Y=e("label",{for:"tel",class:"form-label"},"電話",-1),Z=e("span",{class:"badge text-danger"},"*必填",-1),$={class:"mb-3"},ee=e("label",{for:"mobile",class:"form-label"},"行動電話",-1),se={class:"mb-3"},te=e("label",{for:"address",class:"form-label"},"收件人地址",-1),le=e("span",{class:"badge text-danger"},"*必填",-1),oe={class:"mb-3"},ae=e("label",{for:"message",class:"form-label"},"留言",-1),ne=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function de(a,s,g,v,t,u){const d=f("v-field"),i=f("error-message"),C=f("v-form");return r(),m(b,null,[T,e("table",w,[A,e("tbody",null,[t.carts?(r(!0),m(b,{key:0},V(t.carts,o=>(r(),m("tr",{key:o.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:l=>u.delCart(o.id),disabled:t.loadingItem===o.id},[t.loadingItem===o.id?(r(),m("i",D)):x("",!0),P(" x ")],8,S)]),e("td",null,_(o.product.title),1),e("td",null,[e("div",M,[e("div",R,[y(e("select",{class:"form-select",name:"qty","onUpdate:modelValue":l=>o.qty=l,onChange:l=>u.updateCart(o.id,o.product_id,o.qty),disabled:t.loadingItem===o.id},[(r(),m(b,null,V(10,l=>e("option",{key:l,value:l},_(l),9,L)),64))],40,B),[[U,o.qty]]),N])])]),e("td",O,_(o.final_total),1)]))),128)):x("",!0)]),e("tfoot",null,[e("tr",null,[F,e("td",H,_(t.total),1)])])]),e("div",j,[n(C,{ref:"form",class:"col-md-6",onSubmit:u.submitOrder},{default:I(({errors:o})=>[e("div",z,[W,G,n(d,{id:"email",name:"email",type:"email",class:c(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=l=>t.form.user.email=l)},null,8,["class","modelValue"]),n(i,{name:"email",class:"invalid-feedback"})]),e("div",J,[K,Q,n(d,{id:"name",name:"姓名",type:"text",class:c(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=l=>t.form.user.name=l)},null,8,["class","modelValue"]),n(i,{name:"姓名",class:"invalid-feedback"})]),e("div",X,[Y,Z,n(d,{id:"tel",name:"電話",type:"tel",class:c(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",modelValue:t.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=l=>t.form.user.tel=l),rules:"required|min:8|max:10"},null,8,["class","modelValue"]),n(i,{name:"電話",class:"invalid-feedback"})]),e("div",$,[ee,n(d,{id:"mobile",name:"行動電話",type:"tel",class:c(["form-control",{"is-invalid":o.行動電話}]),placeholder:"請輸入行動電話",modelValue:t.form.user.mobile,"onUpdate:modelValue":s[3]||(s[3]=l=>t.form.user.mobile=l),rules:u.checkMobile},null,8,["class","modelValue","rules"]),n(i,{name:"行動電話",class:"invalid-feedback"})]),e("div",se,[te,le,n(d,{id:"address",name:"地址",type:"text",class:c(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=l=>t.form.user.address=l)},null,8,["class","modelValue"]),n(i,{name:"地址",class:"invalid-feedback"})]),e("div",oe,[ae,y(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[5]||(s[5]=l=>t.form.message=l)},null,512),[[E,t.form.message]])]),ne]),_:1},8,["onSubmit"])])],64)}const re=k(q,[["render",de]]);export{re as default};
